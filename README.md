# Социальная сеть для путешественников - Системный дизайн
Выполняется в качестве домашнего задания на курсе https://platform-balun.ru/teach/control/stream/view/id/921829580

![img.png](img.png)

Социальная сеть для путешественников позволяет обмениваться информацией о посещенных местах
и выбирать новые локации для путешествий.

### Функциональные требования:
- Публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия;
- Оценка и комментарии постов других путешественников;
- Подписка на других путешественников, чтобы следить за их активностью;
- Поиск популярных мест для путешествий и просмотр постов с этих мест;
- Просмотр ленты других путешественников и ленты пользователя, основанной на подписках в обратном хронологическом порядке;

### Нефункциональные требования:
- DAU 10000000 (daily active users)
- Аудитория стран СНГ
- Данные будут храниться всегда
- Активности пользователей:
  - в среднем каждый пользователь пишет 1 пост в неделю, ставит 50 реакций в сутки и пишет 20 комментариев в сутки
  - в среднем каждый пользователь 5 раз в сутки просматривает ленту новостей других путешественников (до 15 постов за 1 раз)
  - в среднем каждый пользователь находит 3 новых места для путешествия и просматривает до 10 постов с каждого места
  - в среднем каждый пользователь в просмотренном посте читает 5 комментариев и смотрит до 16 реакций на пост (1 реакция на пост + 5 реакций на комментарии + 10 реакций на все фото)
  - в среднем каждый пользователь подписывается/отписывается на других пользователей 1 раз в сутки
- Лимиты:
  - 1 пост может содержать максимум 10 фотографий не более 3МБ каждая, заголовок длиной не более 100 символов, текст длиной не более 16000 символов и 1 локацию
  - пользователь может создавать не более 10 постов в сутки
  - пользователь может создавать комментарий с длиной не более 1000 символов без фотографий
- Сезонность: в новогодние каникулы и летние месяцы активность возрастает на 50%
- Тайминги:
  - создание 1 поста 2 секунды
  - создание реакции 1 секунда
  - создание комментария 1 секунда
  - получение результата поиска по месту 3 секунды
  - получение ленты новостей 2 секунды
  - подписка/отписка на пользователя 1 секунда

### Оценка нагрузки:

#### Нагрузка (по подсистемам):
- Посты:
  - RPS (Write) = 10000000 * (1/7) / 86400 =~ 10000000 * (1/7) / 100000 = 100 * 0,143 = 14
  - RPS (Read) = 10000000 * (5*15 + 3*10) / 86400 =~ 10000000 * 105 / 100000 = 100 * 280 = 10500
- Фотографии:
  - RPS (Write) = 10000000 * (1/7) * 10 / 86400 =~ 10000000 * (10/7) / 100000 = 100 * 1,43 = 143
  - RPS (Read) = 10000000 * (5*15 + 3*10) * 10 / 86400 =~ 10000000 * 1050 / 100000 = 100 * 105 = 105000
- Реакции (Оценки):
  - RPS (Write) = 10000000 * 50 / 86400 =~ 10000000 * 50 / 100000 = 100 * 50 = 5000
  - RPS (Read) = 10000000 * (5*15 + 3*10) / 86400 =~ 10000000 * 105 / 100000 = 100 * 105 = 10500
- Комментарии:
  - RPS (Write) = 10000000 * 20 / 86400 =~ 10000000 * 20 / 100000 = 100 * 20 = 2000
  - RPS (Read) = 10000000 * (5*15*5 + 3*10*5) / 86400 =~ 10000000 * 525 / 100000 = 100 * 525 = 52500

#### Размеры по сущностям:
1 пост = 16140 bytes:
- id (8 bytes)
- created_at (8 bytes)
- user_id (8 bytes)
- title (100 bytes)
- text (16000 bytes)
- gps_location (16 bytes)

1 фотография = 3150000 bytes:
- id (8 bytes)
- entity_id (8 bytes)
- entity_type (4 bytes)
- photo (3145728 bytes)

1 реакция = 32 bytes:
- id (8 bytes)
- created_at (8 bytes)
- user_id (8 bytes)
- reaction_type (8 bytes)

1 комментарий = 1024 bytes:
- id (8 bytes)
- created_at (8 bytes)
- user_id (8 bytes)
- text (1000 bytes)

#### Трафик (по подсистемам):
- Посты (без фото):
  - Traffic (Write) = 14 * 16140 = 225960 bytes = 220 KB/s
  - Traffic (Read) = 10500 * 16140 = 161 MB/s
- Фотографии:
  - Traffic (Write) = 143 * 3150000 = 429 MB/s
  - Traffic (Read) = 105000 * 3150000 = 307 GB/s
- Реакции (Оценки):
  - Traffic (Write) = 5000 * 32 = 160000 bytes = 160 KB/s
  - Traffic (Read) = 10500 * 32 = 330 KB/s
- Комментарии:
  - Traffic (Write) = 2000 * 1024 = 2 MB/s
  - Traffic (Read) = 52500 * 1024 = 51 MB/s